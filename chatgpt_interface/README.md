# 🧠 GPT通信模块（chatgpt_interface）

## 模块简介
本模块负责与 GPT 进行通信，作为“贾维斯”的智能对话大脑。可通过网络实时访问 GPT 模型，也支持脱机状态下的缓存或延迟处理模式。

---

## 核心功能
- 实时将用户输入发送给 GPT，获取自然语言回复
- 支持情绪感知与语境记忆
- 支持 GPT 每日更新记忆 / 个性
- 可本地缓冲所有请求，集中上传、批量总结

---

## 通信方案设计

### ✅ 模式一：实时 GPT 聊天模式（在线）
> 与 ChatGPT 类似，实时通信 + 回答 + 语音播报

- 用户对话 → 发送至 GPT → 回应 → 语音合成播放
- 所有内容本地日志备份

### ✅ 模式二：本地代理发起通信
> 语音助手将用户输入模拟成“用户”发送给 GPT（你说的“代理发送”）

- 本地助手记录对话 → 封装内容 → 由助手代表你发给 GPT
- GPT 回复后 → 本地助手朗读、展示
- 保证日志完整、能训练未来模型

### ✅ 模式三：夜间上传 & 训练更新
> 白天本地记录、夜间联网上传、由 GPT 分析总结并更新个性/记忆

- 离线使用时本地缓存 `.log` 文件
- 晚上联网后统一上传并获取 GPT 总结
- 总结结果写入本地记忆系统

---

## 推荐依赖
- `openai`：OpenAI 官方 API 接口
- `requests`：备用 HTTP 工具
- `dotenv`：加载 API 密钥
- `json`：缓存与日志记录格式

---

## 使用示例
```python
from send_to_gpt import ask_gpt
reply = ask_gpt("今天我心情不好")
print(reply)
```

---

## 开发计划
- [x] 基础通信功能（OpenAI）
- [x] 请求异常处理
- [x] 本地缓存请求与回应
- [ ] 夜间批量总结机制
- [ ] 情绪感知模块对接
- [ ] 与“记忆模块”联动更新

---

## 使用成本估计 💰

| 模式               | 使用频率         | 预计每日Token | 费用估计（$10/百万tokens） |
|--------------------|------------------|---------------|-----------------------------|
| 实时通信           | 10~30次对话      | 5,000~15,000  | $0.05 ~ $0.15 / 天          |
| 夜间总结同步       | 每晚1次上传日志  | 4,000~8,000   | $0.04 ~ $0.08 / 天          |
| 本地缓存后集中处理 | 视使用频率而定   | 可控           | 更低，成本集中              |

> 粗略估计一个月总费用：**$5 ~ $10 美元**  
> 若每天聊天超 100 条：可能涨至 **$20+**，建议使用缓存+总结压缩策略
